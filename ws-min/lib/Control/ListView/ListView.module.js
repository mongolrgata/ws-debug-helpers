$ws.declareModule({namespace:"SBIS3.CORE",name:"ListView",imports:["SBIS3.CORE.DataView"]},function(a){$ws.proto.ListView=a.extend({$protected:{_options:{display:{displayValue:""},mode:"oneClickMode"}},_createContainer:function(){var c="",b=this._options.display.showRecordsCount||this._options.display.showPaging||this._options.display.showSelectionCheckbox?'<div class="ws-browser-footer"><table class="ws-browser-foot" cellspacing="0"><tfoot><tr><td class="ws-browser-pager-cont"></td></tr></tfoot></table></div>':"";if(this._options.display.showToolbar||this._options.viewType=="hierarchy"){c='<div class="ws-browser-head-container"></div>';}this._container.append('<div class="ws-browser-ajax-loader ws-hidden"><div class="ws-loading-indicator-outer"><div class="ws-loading-indicator-block"><div class="ws-loading-indicator ws-browser-loading-indicator">'+($ws._const.theme==="wi_scheme"?"":"Загрузка")+"</div></div></div></div>").append(this._rootElement=$('<div class="ws-browser-data-container ws-listview"><div>'+c+'<div class="ws-browser-container-wrapper"><div class="ws-browser-container" tabindex="-1"><div class="ws-browser"/></div></div>'+b+"</div>"));this._body=this._rootElement.find(".ws-browser").height(this._isHeightGrowable()?"Auto":"100%");$ws.proto.ListView.superclass._createContainer.apply(this,arguments);this._emptyDataBlock.addClass("listView");},_drawBodyCycle:function(){var j,d=0,g=0,b=document.createElement("div"),f=this._data.parent(),e,h;this._currentRecordSet.rewind();while((j=this._currentRecordSet.next())!==false){if(this._options.display.viewType!=="hierarchy"||(this._options.display.viewType==="hierarchy"&&j.get(this._hierColumnParentId)==this._currentRootId||this._turn=="OnlyLeaves"||this._turn=="OnlyFolders")){e=j.getKey();h=this._options.display.displayValue.apply(this,[j]);if(h){if(h instanceof Object&&"jquery" in h){h.attr("rowkey",e);if(this.isHierarchyMode()&&j.get(this._hierColumnIsLeaf)===true){h.addClass("ws-browser-folder");if(this._options.mode==="oneClickMode"){h.addClass("ws-browser-folder-link");}}else{if(this._options.mode==="oneClickMode"){h.addClass("ws-browser-edit-link");}}h.addClass("ws-visible");$(b).append(h);++g;}else{$ws.single.ioc.resolve("ILogger").log("ListView","element rendering function returned not a jQuery element");}}}d++;}this._count=g;this._body.remove();this._body=$(b).addClass("ws-browser").height(this._isHeightGrowable()?"Auto":"100%");this._data=this._body;f.append(b);if(this._haveAutoWidth()){b=this._rootElement.find(".ws-browser-container");b.css("float","left");var k=this._rootElement.find(".ws-browser-footer").hide(),i=this._rootElement.find(".ws-browser-head-container").hide();this._container.css("width",10000);b.find(".ws-browser").css("overflow","hidden");var c=b.width();i.css("width",c).show();k.css("width",c).show();this._container.css("width","auto");setTimeout(function(){b.find(".ws-browser").css("overflow","");},0);b.css("float","");}},_setWidth:function(){var b=this._options.display.width;this._container.width(b);},_redraw:function(){}});return $ws.proto.ListView;});