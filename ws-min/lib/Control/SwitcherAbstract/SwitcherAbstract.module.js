$ws.declareModule({namespace:"SBIS3.CORE",name:"SwitcherAbstract",imports:["SBIS3.CORE.Control"]},function(a){$ws.proto.SwitcherAbstract=a.DataBoundControl.extend({$protected:{_options:{value:false,textOff:"",textOn:""},_toggler:undefined,_togglerLeft:undefined,_togglerRight:undefined,_textContainer:undefined,_textOffContainer:undefined,_textOnContainer:undefined,_textOff:undefined,_textOn:undefined,_value:false,_keysCallbackMap:{},_keysWeHandle:[$ws._const.key.space,$ws._const.key.left,$ws._const.key.right]},$constructor:function(){this._initValues();this._createContainer();this._initKeys();this._initSaveState();this.setEnabled(this._options.enable);},_initSaveState:function(){if(this._options.saveState){$ws.single.ControlStorage.waitChildByName(this.getName()).addCallback(function(){this._notify("onStateChanged");}.bind(this));}},applyState:function(b){this.setValue(b==="true");},_initValues:function(){this._textOff=this._options.textOff;this._textOn=this._options.textOn;},_createContainer:function(){this._container.addClass("ws-switcher ws-no-select").attr("unselectable","on").bind("selectstart",false);this._redraw(true);},_setValueByUser:function(b){var c=this._value;this.setValue(b);if(c!==this._value){this._notify("onChange",b);}},toggle:function(){this.setValue(!this._value);},_userAction:function(b){if(this.isEnabled()){b.call(this);}},_toggleByUser:function(){this._setValueByUser(!this._value);},_bindBlocks:function(){},setValue:function(b){if(typeof(b)==="boolean"){this._setValueInternal(b);this._updateSelfContextValue(this._value);}},_toggleClasses:function(b){},_setValueInternal:function(b){if(b===null||b===undefined){b=false;}var c=this._value;if(typeof(b)==="boolean"){this._value=b;this._toggleClasses(b);if(c!==b){this._notify("onStateChanged",b);this._notifyOnValueChange(b);}}},_onContextValueReceived:function(b){if(b!==undefined){this._setValueInternal(b);}},setText:function(c,b){this._textOffContainer.text(this._textOff=c);this._textOnContainer.text(this._textOn=b);},setTextOff:function(b){this._textOffContainer.text(this._textOff=b);},getTextOff:function(){return this._textOff;},setTextOn:function(b){this._textOnContainer.text(this._textOn=b);},getTextOn:function(){return this._textOn;},getStringValue:function(){if(this.getValue()){return this.getTextOn();}return this.getTextOff();},setEnabled:function(b){$ws.proto.SwitcherAbstract.superclass.setEnabled.apply(this,arguments);this._container.toggleClass("ws-enabled");},_getDefaultValue:function(){var b=function(c){return !!c;};if(typeof(this._options.value)==="function"){return b(this._options.value());}return b(this._options.value);},_keyLeft:function(){if(this._value===true){this._setValueByUser(false);}},_keyRight:function(){if(this._value===false){this._setValueByUser(true);}},_initKeys:function(){this._keysCallbackMap[$ws._const.key.space]=this._toggleByUser;this._keysCallbackMap[$ws._const.key.left]=this._keyLeft;this._keysCallbackMap[$ws._const.key.right]=this._keyRight;},_keyboardHover:function(c){var b=c.which;if(b in this._keysCallbackMap){this._keysCallbackMap[b].call(this);}},_getMarkupTemplate:function(){return"";},_getContainerHTML:function(){return"";},_redraw:function(b){if(!this._hasMarkup()){this._container.html(this._getContainerHTML());}this._bindBlocks();if(!b){this.setEnabled(this._options.enable);}}});return $ws.proto.SwitcherAbstract;});