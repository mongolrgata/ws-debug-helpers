$ws.declareModule({namespace:"SBIS3.CORE",name:"Slider",imports:["SBIS3.CORE.Control"]},function(a){$ws.proto.Slider=a.Control.extend({$protected:{_options:{from:0,to:100,step:1,round:0,dimension:"",limits:false,scale:"",scaleStep:null,low:0,high:null,onstatechange:null},_dReady:false,_isReady:false,_slider:null},$constructor:function(){this._options.low=parseFloat(this._options.low);this._options.from=parseFloat(this._options.from);this._options.to=parseFloat(this._options.to);this._options.step=parseFloat(this._options.step);if(this._options.scaleStep!==null){this._options.scaleStep=parseFloat(this._options.scaleStep);}if(this._options.high!==null){this._options.high=parseFloat(this._options.high);}this._options.round=parseInt(this._options.round,10);var b=this;var c="";c+=this._options.low;if(this._options.high!==null){c+=";"+this._options.high;}this._dReady=new $ws.proto.Deferred();b._slider=$('<input value="'+c+'" />');this._container.append(b._slider);this._options.onstatechange=function(d){var e=b._parseValues(d);b._options.low=e[0];b._options.high=e[1];b._notify("onChange",e);};$ws.core.attach("ext/slider/jquery.slider-full.js").addCallback(function(){b._dReady.callback();b._isReady=true;b._redraw();b._notify("onReady");});},_redraw:function(){var b=this;if(b._slider){b._container.empty();var c="";c+=this._options.low;if(this._options.high!==null){c+=";"+this._options.high;}b._slider=$('<input value="'+c+'" />');b._container.append(b._slider);}this._dReady.addCallback(function(){b._slider.slider(b._options);b.getValues();});},_parseValues:function(b){var c=b.split(";");if(c[1]===undefined){c[1]=null;}return c;},getValues:function(){if(this._isReady){var b=this._parseValues(this._slider.slider("value"));this._options.low=b[0];this._options.high=b[1];return b;}else{return[null,null];}},setValues:function(e,b){var d=this._options.from,f=this._options.to,g=this._options.step;if((e<d)||(e>=f-g)){e=d;}if((b>f)||(b<=d+g)){b=f;}this._options.low=e;this._options.high=b;var c=this;this._dReady.addCallback(function(){c._slider.slider("value",e,b);});},setStep:function(c){var b=this._options.to-this._options.from;if(c>b){c=b;}this._options.step=c;this._redraw();},setScaleStep:function(b){var c=this._options.to-this._options.from;if(b>c){b=c;}this._options.scale="";this._options.scaleStep=b;this._redraw();},setBounds:function(f,h){this._options.from=f;this._options.to=h;var e=this.getValues(),g=e[0],b=e[1],i=this._options.step,c=this._options.scaleStep,d=h-f;if(i>d){i=d;}if(c>d){c=d;}if((g<f)||(g>=h-i)){g=f;}if((b>h)||(b<=f+i)){b=h;}this._options.scaleStep=c;this._options.step=i;this._options.low=g;this._options.high=b;this._redraw();}});return $ws.proto.Slider;});