$ws.declareModule({namespace:"SBIS3.CORE",name:"HierarchyCustomView",imports:["SBIS3.CORE.HierarchyViewAbstract"]},function(a){$ws.proto.HierarchyCustomView=a.extend({$protected:{_options:{display:{displayValue:""}}},_createContainer:function(){$ws.proto.HierarchyCustomView.superclass._createContainer.apply(this,arguments);this._container.find(".ws-browser-data-container").addClass("ws-listview");this._body=this._rootElement.find(".ws-browser").height(this._isHeightGrowable()?"Auto":"100%");this._emptyDataBlock.addClass("listView");},_drawBodyCycle:function(){var d,h=0,g=0,c=$(document.createElement("div")),b=this._data.parent(),f,e;this._currentRecordSet.rewind();this._selectedRecords=[];while((d=this._currentRecordSet.next())!==false){f=this._renderElement(d);e=d.getKey();if(f){f.attr("rowkey",e);f.addClass("ws-visible");if(this._selected&&this._selected[e]!==undefined){f.addClass("ws-browser-selected");this._selectedRecords.push(d);}c.append(f);++g;}h++;}this._count=g;this._body.remove();this._body=c.addClass("ws-browser").height(this._isHeightGrowable()?"Auto":"100%");this._data=this._body;b.append(c);this._notifyOnSizeChanged(this,this);},_renderElement:function(b){var c=this._options.display.displayValue.apply(this,[b]);if(b.get(this._hierColumnParentId)===this._currentRootId||this._turn in {OnlyLeaves:true,OnlyFolders:true}){if(c instanceof Object&&"jquery" in c){if(b.get(this._hierColumnIsLeaf)===true){c.addClass("ws-browser-folder");if(this._options.mode==="oneClickMode"){c.addClass("ws-browser-folder-link");}}else{if(this._options.mode==="oneClickMode"){c.addClass("ws-browser-edit-link");}}return c;}else{$ws.single.ioc.resolve("ILogger").log("ListView","element rendering function returned not a jQuery element");}}return false;},_initEvents:function(){var b=this,c;function e(i){var f=$(this),j=f.closest("[rowkey]"),h=j.attr("rowkey"),g=h&&b._currentRecordSet.contains(h)?b._currentRecordSet.getRecordByPrimaryKey(h):undefined;b._onClickHandler(i);if(b.isEnabled()){h=(h==="null"||!h)?null:h;if(i.type==="dblclick"){b._dblClickHandler.apply(b,[j,g]);}else{b._oneClickHandler.apply(b,[j,g]);}}return b._options.editMode=="thisWindow";}var d=$("[rowkey]",b._body.parent()[0]).live("mousedown",function(){if(b.isEnabled()){b.setActiveElement($(this),false,true);}});d.wsFixedLiveClick2(e,e);},_redraw:function(){}});return $ws.proto.HierarchyCustomView;});