$ws.declareModule({namespace:"SBIS3.CORE",name:"FieldCheckbox",imports:["SBIS3.CORE.FieldAbstract"]},function(a){$ws.proto.FieldCheckbox=a.extend({$protected:{_box:null,_options:{caption:"",isThirdPosition:false,width:"100%",align:"left"},_nullable:{value:false},_curval:"false",_caption:"",_keysWeHandle:[$ws._const.key.space]},$constructor:function(){var b=this;this._caption=this._options.caption;this._curval=typeof this._options.value=="boolean"?this._options.value.toString():this._curval;this._box.addClass(this._curval);this._container.addClass("ws-field-checkbox").attr("title",this._options.tooltip).addClass("ws-checkbox-"+this._options.align);var c;if((c=this._container.parent()).hasClass("ws-labeled-control ws-non-control")){c.addClass("bind-for-checkbox");}this._inputControl.click(function(){if(b.isEnabled()){b._changeState();}});},_keyboardHover:function(b){if(b.which===$ws._const.key.space&&this.isEnabled()){this._changeState();}},_createMarkup:function(c){var b=$ws.proto.FieldCheckbox.superclass._createMarkup.apply(this,arguments);return this._extendMarkup(b,"<div class='box'></div><label class='checkbox-label'>{{=it.caption}}</label>");},_bindInternals:function(){this._box=this._container.find(".box");this._inputControl=this._container.find(".box, .checkbox-label");},_getDefaultValue:function(){var b=this,c=function(e){if(typeof e==="boolean"){return e;}else{if(e===null&&b._options.isThirdPosition){return null;}else{$ws.single.ioc.resolve("ILogger").error("FieldCheckBox::_getDefaultValue","Incorrect default value "+e);}}return false;};if(typeof this._options.value==="function"){var d=this._options.value();return c(d);}return c(this._options.value);},_defaultValueHandler:function(){this.setValue(this.getDefaultValue());},_changeState:function(){this.setValue({"true":this._options.isThirdPosition?"null":"false","false":"true","null":"false"}[this._curval]);this._notify("onChange",this._notFormatedVal());},_setValueInternal:function(b){b=(b===null||b===undefined)?"null":b.toString();this._curval=b==="null"&&!this._options.isThirdPosition?false:b;this._box.removeClass().addClass("box").addClass(this._curval);},_notFormatedVal:function(){return{"true":true,"false":false,"null":null}[this._curval];},setEnabled:function(b){$ws.proto.Control.prototype.setEnabled.apply(this,arguments);},setCaption:function(b){this._caption=b;this._inputControl[1].innerHTML=b;},getCaption:function(){return this._caption;},getStringValue:function(){var b;if(this.getValue()){b=this._options.caption?this._options.caption:this.getName();}else{b="";}return b;},_redraw:function(){this._container.attr("title",this._options.tooltip);this._container.removeClass("ws-checkbox-left");this._container.removeClass("ws-checkbox-right");this._container.addClass("ws-checkbox-"+this._options.align);}});return $ws.proto.FieldCheckbox;});